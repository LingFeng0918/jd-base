window.JDCookie=function(e){var t,n,o,s,l,d,r;e=e||".";var i=document.createElement("script");function a(e){var t=e.url,n=e.method,o=e.data,s=e.success,l=new XMLHttpRequest;l.open(n,t),"post"==n&&l.setRequestHeader("Content-type","application/json"),l.send(JSON.stringify(o)),l.onreadystatechange=function(){4==l.readyState&&200==l.status&&s(JSON.parse(l.responseText))}}i.type="text/javascript",i.src="https://cdn.jsdelivr.net/npm/davidshimjs-qrcodejs@0.0.2/qrcode.min.js",i.onload=function(){(t=document.createElement("div")).id="mask",t.style.position="fixed",t.style.top=0,t.style.right=0,t.style.bottom=0,t.style.left=0,t.style.height="100%",t.style.display="flex",t.style.justifyContent="center",t.style.alignItems="center",t.style.textAlign="center",t.style.backgroundColor="rgba(0, 0, 0, 0.45)",t.style.zIndex=1001,document.body.appendChild(t),(n=document.createElement("div")).style.position="relative",n.style.width="256px",n.style.padding="16px",n.style.borderRadius="8px",n.style.border="#6d8a88 1px solid",n.style.backgroundColor="#fff",n.style.boxShadow="0px 0px 7px 3px rgb(0 0 0 / 20%)",n.style.boxSizing="content-box",t.appendChild(n),(o=document.createElement("div")).id="qrcode",n.appendChild(o),s=new QRCode(o,{text:"还在加载呢扫什么扫",correctLevel:QRCode.CorrectLevel.L}),(l=document.createElement("div")).style.position="absolute",l.style.top="16px",l.style.left="16px",l.style.width="256px",l.style.height="256px",l.style.display="none",l.style.justifyContent="center",l.style.alignItems="center",l.style.color="#ffffff",l.style.backgroundColor="rgba(0, 0, 0, 0.5)",l.innerHTML="<h3>二维码已失效</h3>",n.appendChild(l),msgInput=document.createElement("input"),msgInput.id="msg",msgInput.placeholder="请输入备注信息，方便管理员识别账号",msgInput.style.width="100%",msgInput.style.height="24px",msgInput.style.marginTop="16px",n.appendChild(msgInput),(d=document.createElement("div")).style.wordBreak="break-word",d.style.paddingTop="16px",d.innerHTML="<span style=\"color:red;\">先填写备注信息再扫码！！！</span><br><br>请使用京东APP扫码<br>或截图用京东APP扫码<br>完成后请回到此页面复制cookie<br>请无视升级提示",n.appendChild(d),function(){let t=(new Date).getTime();a({url:e+"/qrcode?t="+t,method:"get",success:function(t){var n;0==t.err&&(l.style.display="none",s.clear(),s.makeCode(t.qrcode),n=t.user,r=setInterval((()=>{let t=(new Date).getTime();a({url:e+"/cookie?t="+t,method:"post",data:{user:n,msg:msgInput.value},success:function(e){0==e.err?(clearInterval(r),s.clear(),o.remove(),userMsg=msgInput.value,msgInput.remove(),d.innerHTML="<span>"+userMsg+"</span><p>"+e.cookie+'</p><button id="copyToClip">复制</button>',document.getElementById("copyToClip").onclick=function(){var t=document.createElement("input");t.setAttribute("value",e.cookie),document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t)}):21==e.err&&(clearInterval(r),l.style.display="flex")}})}),3e3))}})}(),t.onclick=function(e){console.log(e.target.id),"mask"===e.target.id&&(clearInterval(r),t.remove())}},document.getElementsByTagName("head")[0].appendChild(i)};
